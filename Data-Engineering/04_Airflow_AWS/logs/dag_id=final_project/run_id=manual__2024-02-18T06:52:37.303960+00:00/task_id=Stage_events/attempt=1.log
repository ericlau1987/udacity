[2024-02-18T06:52:39.888+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: final_project.Stage_events manual__2024-02-18T06:52:37.303960+00:00 [queued]>
[2024-02-18T06:52:39.892+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: final_project.Stage_events manual__2024-02-18T06:52:37.303960+00:00 [queued]>
[2024-02-18T06:52:39.893+0000] {taskinstance.py:2171} INFO - Starting attempt 1 of 1
[2024-02-18T06:52:39.899+0000] {taskinstance.py:2192} INFO - Executing <Task(StageToRedshiftOperator): Stage_events> on 2024-02-18 06:52:37.303960+00:00
[2024-02-18T06:52:39.902+0000] {standard_task_runner.py:60} INFO - Started process 21277 to run task
[2024-02-18T06:52:39.905+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'final_project', 'Stage_events', 'manual__2024-02-18T06:52:37.303960+00:00', '--job-id', '28', '--raw', '--subdir', 'DAGS_FOLDER/final_project.py', '--cfg-path', '/tmp/tmpg3hiipov']
[2024-02-18T06:52:39.907+0000] {standard_task_runner.py:88} INFO - Job 28: Subtask Stage_events
[2024-02-18T06:52:39.936+0000] {task_command.py:423} INFO - Running <TaskInstance: final_project.Stage_events manual__2024-02-18T06:52:37.303960+00:00 [running]> on host 6b28116ad14a
[2024-02-18T06:52:39.971+0000] {taskinstance.py:2481} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='udacity' AIRFLOW_CTX_DAG_ID='final_project' AIRFLOW_CTX_TASK_ID='Stage_events' AIRFLOW_CTX_EXECUTION_DATE='2024-02-18T06:52:37.303960+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-02-18T06:52:37.303960+00:00'
[2024-02-18T06:52:39.978+0000] {base.py:83} INFO - Using connection ID 'aws_credentials' for task execution.
[2024-02-18T06:52:39.978+0000] {connection_wrapper.py:378} INFO - AWS Connection (conn_id='aws_credentials', conn_type='aws') credentials retrieved from login and password.
[2024-02-18T06:52:39.989+0000] {base.py:83} INFO - Using connection ID 'redshift' for task execution.
[2024-02-18T06:52:44.810+0000] {sql.py:432} INFO - Running statement: create schema if not exists staging, parameters: None
[2024-02-18T06:52:48.971+0000] {stage_redshift.py:58} INFO - Drop table staging.staging_events from destination Redshift table
[2024-02-18T06:52:48.986+0000] {base.py:83} INFO - Using connection ID 'redshift' for task execution.
[2024-02-18T06:52:54.948+0000] {sql.py:432} INFO - Running statement: Drop table if exists staging.staging_events, parameters: None
[2024-02-18T06:52:57.648+0000] {stage_redshift.py:61} INFO - Create table staging.staging_events from destination Redshift table
[2024-02-18T06:52:57.669+0000] {base.py:83} INFO - Using connection ID 'redshift' for task execution.
[2024-02-18T06:53:05.863+0000] {sql.py:432} INFO - Running statement: 
    create table if not exists staging.staging_events (
        artist text,
        auth text,
        firstname text,
        gender text,
        iteminsession int,
        lastname text,
        length double precision,
        level text,
        location text,
        method text,
        page text,
        registration bigint,
        sessionid int,
        song text,
        status int,
        ts bigint,
        useragent varchar(1000),
        userid text
    )
    , parameters: None
[2024-02-18T06:53:09.279+0000] {stage_redshift.py:64} INFO - Copying data from S3 to Redshift
[2024-02-18T06:53:09.290+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.296+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.297+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.298+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.298+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.299+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.299+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.300+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.300+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.300+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.301+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.301+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/context.py:207: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-18T06:53:09.313+0000] {base.py:83} INFO - Using connection ID 'redshift' for task execution.
[2024-02-18T06:53:14.512+0000] {sql.py:432} INFO - Running statement: 
        copy staging.staging_events from 's3://ericliu-udacity-lake-house/log-data' 
            format as json 'auto ignorecase'
            ACCESS_KEY_ID 'AKIAXNLLYAMLPRRBUZMF'
            SECRET_ACCESS_KEY '***';
        , parameters: None
[2024-02-18T06:53:40.744+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=final_project, task_id=Stage_events, execution_date=20240218T065237, start_date=20240218T065239, end_date=20240218T065340
[2024-02-18T06:53:40.796+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-02-18T06:53:40.807+0000] {taskinstance.py:3281} INFO - 0 downstream tasks scheduled from follow-on schedule check
